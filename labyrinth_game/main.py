#!/usr/bin/env python3
"""–û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –∏–≥—Ä—ã –õ–∞–±–∏—Ä–∏–Ω—Ç —Å–æ–∫—Ä–æ–≤–∏—â."""

import player_actions
import utils


def process_command(game_state, command):
    """
    –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É, –≤–≤–µ–¥–µ–Ω–Ω—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
    
    Args:
        game_state (dict): –°–ª–æ–≤–∞—Ä—å —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏–≥—Ä—ã
        command (str): –ö–æ–º–∞–Ω–¥–∞, –≤–≤–µ–¥–µ–Ω–Ω–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
    """
    # –†–∞–∑–¥–µ–ª—è–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞ —á–∞—Å—Ç–∏, —á—Ç–æ–±—ã –æ—Ç–¥–µ–ª–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –æ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç–∞
    parts = command.split()
    if not parts:
        return
    
    action = parts[0]
    argument = parts[1] if len(parts) > 1 else None
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º match / case –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã
    match action:
        case 'look':
            utils.describe_current_room(game_state)
        
        case 'go':
            if argument:
                player_actions.move_player(game_state, argument)
            else:
                print("–£–∫–∞–∂–∏—Ç–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: go <–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ>")
        
        case 'take':
            if argument:
                player_actions.take_item(game_state, argument)
            else:
                print("–£–∫–∞–∂–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç: take <–ø—Ä–µ–¥–º–µ—Ç>")
        
        case 'inventory':
            player_actions.show_inventory(game_state)
        
        case 'quit' | 'exit':
            print("–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–≥—Ä—É! –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!")
            game_state['game_over'] = True
        
        case _:
            print(f"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞: '{command}'. –í–≤–µ–¥–∏—Ç–µ 'help' –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏.")


def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–≥—Ä—ã –õ–∞–±–∏—Ä–∏–Ω—Ç —Å–æ–∫—Ä–æ–≤–∏—â."""
    # –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    print("–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –õ–∞–±–∏—Ä–∏–Ω—Ç —Å–æ–∫—Ä–æ–≤–∏—â!")
    
    # –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
    game_state = {
        'player_inventory': [],  # –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏–≥—Ä–æ–∫–∞
        'current_room': 'entrance',  # –¢–µ–∫—É—â–∞—è –∫–æ–º–Ω–∞—Ç–∞
        'game_over': False,  # –ó–Ω–∞—á–µ–Ω–∏–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã
        'steps_taken': 0  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤
    }
    
    # –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∞—Ä—Ç–æ–≤–æ–π –∫–æ–º–Ω–∞—Ç—ã
    utils.describe_current_room(game_state)
    
    # –í—ã–≤–æ–¥ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
    print("\nüí° –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:")
    print("  look - –æ—Å–º–æ—Ç—Ä–µ—Ç—å—Å—è")
    print("  inventory - –ø–æ–∫–∞–∑–∞—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å")
    print("  go <–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ> - –ø–æ–π—Ç–∏ –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏")
    print("  take <–ø—Ä–µ–¥–º–µ—Ç> - –ø–æ–¥–æ–±—Ä–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç")
    print("  quit - –≤—ã–π—Ç–∏ –∏–∑ –∏–≥—Ä—ã")
    print("  help - –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É")
    
    # –û—Å–Ω–æ–≤–Ω–æ–π –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
    while not game_state['game_over']:
        # –°—á–∏—Ç—ã–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø–æ–º–æ—â—å—é –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
        command = player_actions.get_input("\n–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É: ")
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ process_command
        process_command(game_state, command)


if __name__ == "__main__":
    main()